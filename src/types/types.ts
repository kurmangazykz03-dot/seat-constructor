// Базовые типы для схемы зала (зоны, ряды, места, шейпы, текст)

/**
 * Тип фигуры на схеме:
 *  - rect    — прямоугольник
 *  - ellipse — эллипс
 *  - polygon — произвольный многоугольник
 */
export type ShapeKind = "rect" | "ellipse" | "polygon";

/**
 * Точка фигуры в локальных координатах (относительно bbox фигуры).
 */
export interface ShapePoint {
  x: number;
  y: number;
}

/**
 * ShapeObject — произвольная фигура на схеме (декор, сцена, блоки и т.п.).
 * Используется как «фоновый» объект, не связанный напрямую с местами.
 */
export interface ShapeObject {
  /** Уникальный ID шейпа */
  id: string;

  /** Тип фигуры (прямоугольник/эллипс/многоугольник) */
  kind: ShapeKind;

  /** Позиция шейпа на сцене (верхний левый угол bbox, в координатах схемы) */
  x: number;
  y: number;

  /** Размеры шейпа (ширина / высота) в пикселях */
  width: number;
  height: number;

  /** Цвет заливки (если не задан — может быть прозрачным) */
  fill?: string;

  /** Цвет обводки */
  stroke?: string;

  /** Толщина обводки */
  strokeWidth?: number;

  /** Прозрачность шейпа (0–1) */
  opacity?: number;

  /** Поворот шейпа в градусах (0 по умолчанию) */
  rotation?: number;

  /** Отражение по оси X (горизонтальный флип) */
  flipX?: boolean;

  /** Отражение по оси Y (вертикальный флип) */
  flipY?: boolean;

  /**
   * Для kind === "polygon":
   *   - массив точек в локальных координатах внутри bbox (0..width, 0..height)
   * Для rect/ellipse обычно не используется.
   */
  points?: ShapePoint[];
}

/**
 * Row — логический ряд мест внутри зоны (или свободный ряд, если zoneId = null).
 * Хранит позицию подписи ряда и ссылку на зону.
 */
export interface Row {
  /** Уникальный ID ряда */
  id: string;

  /** ID зоны, к которой относится ряд (null — ряд вне зоны) */
  zoneId: string | null;

  /** Индекс ряда внутри зоны (для сортировки) */
  index: number;

  /** Текстовая подпись ряда (например, "1", "A") */
  label: string;

  /** Позиция ряда на схеме (координата подписи, в локальных координатах зоны или сцены) */
  x: number;
  y: number;
}

/**
 * Seat — отдельное место на схеме (кресло).
 */
export interface Seat {
  /** Уникальный ID места */
  id: string;

  /** Позиция центра места (в локальных координатах либо зоны, либо сцены) */
  x: number;
  y: number;

  /** Радиус кружка места в пикселях */
  radius: number;

  /** Цвет заливки места (как правило, зависит от статуса/категории) */
  fill?: string;

  /** Подпись места (номер, буква и т.п.) */
  label: string;

  /** ID зоны, к которой относится место (null — свободное место вне зон) */
  zoneId: string | null;

  /** ID ряда, к которому относится место (null — свободное / вне ряда) */
  rowId: string | null;

  /**
   * Порядковый номер в ряду (для нумерации слева-направо/справа-налево).
   * Можно пересчитывать при перестройке ряда.
   */
  colIndex: number | null;

  /** Статус места (доступно/занято/недоступно) */
  status?: "available" | "occupied" | "disabled";

  /** Произвольная категория места (standard, vip, discount и т.п.) */
  category?: string;
}

/**
 * Zone — прямоугольная зона зала (сектор).
 * Внутри неё располагаются ряды и места, а также задаются угол клина/шаг сетки.
 */
export interface Zone {
  /** Уникальный ID зоны */
  id: string;

  /** Позиция зоны на сцене (левый верхний угол) */
  x: number;
  y: number;

  /** Размеры зоны (ширина / высота) */
  width: number;
  height: number;

  /** Поворот зоны целиком (в градусах) */
  rotation?: number;

  /** Базовый цвет фона зоны (если не используется transparent) */
  fill?: string;

  /** Флаг прозрачного фона (true — фон не рисуем) */
  transparent?: boolean;

  /** Прозрачность заливки зоны (0–1) */
  fillOpacity?: number;

  /**
   * Клин зоны: углы нижних углов прямоугольника (в градусах).
   * Используются для изгиба рядов/мест относительно сцены.
   */
  angleLeftDeg?: number;
  angleRightDeg?: number;

  /** Текстовая подпись зоны (например, "Партер") */
  label?: string;

  /** Шаг по X между местами в зоне (для авто-раскладки) */
  seatSpacingX?: number;

  /** Шаг по Y между рядами в зоне (для авто-раскладки) */
  seatSpacingY?: number;

  /**
   * Сторона, с которой рисуются подписи рядов относительно зоны:
   *  - "left"  — метки слева
   *  - "right" — метки справа
   */
  rowLabelSide?: "left" | "right";
}

/**
 * TextObject — произвольный текст на схеме (названия, подсказки, легенда).
 */
export interface TextObject {
  /** Уникальный ID текстового элемента */
  id: string;

  /** Содержимое текста */
  text: string;

  /** Позиция текста на схеме (левый верхний угол текста) */
  x: number;
  y: number;

  /** Размер шрифта в пикселях */
  fontSize: number;

  /** Поворот текста в градусах (опционально) */
  rotation?: number;

  /** Цвет текста */
  fill?: string;

  /** Имя шрифта (если нужно принудительно задать семейство) */
  fontFamily?: string;
}
